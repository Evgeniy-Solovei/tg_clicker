import{j as s,u as Q,r as z,i as O,k as K,l as A,D as L}from"./index-BCgauqsv.js";import{i as $}from"./imgCoin-DwLBqyid.js";import{H as T}from"./Header-CqGop2kH.js";import{u as S}from"./useMutation-CA-fW94i.js";import{h as I,q as u,i as M,u as W,j as X}from"./gueryClient-COM-SMWA.js";import{u as w,f as D,a as Y}from"./formatNumber-C8mRh9jw.js";const Z="_root_1lfwx_1",R="_cost_window_1lfwx_14",J="_container_1lfwx_30",V="_fon_1lfwx_40",ss="_box_1lfwx_48",es="_imgEnotBack_1lfwx_53",ts="_slogan_1lfwx_65",is="_text_slogan_1lfwx_85",ns="_imgCoin_1lfwx_103",os="_cost_text_1lfwx_111",d={root:Z,cost_window:R,container:J,fon:V,box:ss,imgEnotBack:es,slogan:ts,text_slogan:is,imgCoin:ns,cost_text:os},N="/assets/coinPrize-BsQWk6-a.png",h="/assets/energyPrize-C6pF5lWi.png",B="/assets/diamondsPrize-CaNP9zhv.png",F="/assets/botPrize-CD0cXvET.png",cs="/assets/skinPrize-Csi9GH01.png",U="/assets/box1-D3XQbKnU.png",q="/assets/box2-_a3OpZPI.png",H="/assets/box3-BQ05YlqY.png",as="/assets/imgFon-dCH78UyA.png",rs="_container_box_prize_7nygw_1",_s="_fon_7nygw_11",ms="_box_prize_7nygw_19",gs="_imgEnotFace_7nygw_27",xs="_loot_box_7nygw_39",ls="_imgBox_7nygw_47",ps="_imgBumble_7nygw_54",ds="_box_info_prize_7nygw_62",bs="_possible_prize_7nygw_72",zs="_title_prize1_7nygw_88",us="_title_prize_7nygw_88",js="_box_getting_prize_7nygw_121",fs="_getting_prize_7nygw_131",ws="_imgPrize_7nygw_140",ys="_imgPrize1_7nygw_144",Ns="_icon_prize_7nygw_148",hs="_cost_window_7nygw_155",Bs="_cost_text_7nygw_171",Cs="_imgCoin_7nygw_186",t={container_box_prize:rs,fon:_s,box_prize:ms,imgEnotFace:gs,loot_box:xs,imgBox:ls,imgBumble:ps,box_info_prize:ds,possible_prize:bs,title_prize1:zs,title_prize:us,box_getting_prize:js,getting_prize:fs,imgPrize:ws,imgPrize1:ys,icon_prize:Ns,cost_window:hs,cost_text:Bs,imgCoin:Cs},ks="_btn_y0wee_1",Ps="_btn2_y0wee_20",G={btn:ks,btn2:Ps};function vs({...r}){return s.jsx("button",{...r,className:G.btn,children:"Получить"})}const Es="/assets/EnotFaceBackground-DCMBUzNC.png",Fs="/assets/bumbleLight-_3kQzhIG.png";function $s({...r}){return s.jsx("button",{...r,className:G.btn2,children:"Забрать"})}function v({box:r,lootBox:n,imgBox:i,setTypeBox:_}){const{tg:x,tg_id:o}=Q(),[c,m]=z.useState([]),[l,y]=z.useState(),j=w(e=>{var a;return(a=e.dataUser.getUser)==null?void 0:a.coin}),{mutate:g}=S({mutationFn:e=>I(e.name_box,e.tg_id),onSuccess:e=>{x.HapticFeedback.impactOccurred("light"),m(e),u.invalidateQueries({queryKey:["userData"]}),u.invalidateQueries({queryKey:["boxesData"]}),C(2)}},u),b=S({mutationFn:e=>M(e.prizes,e.tg_id),onSuccess:e=>{y(e),u.invalidateQueries({queryKey:["userData"]}),u.invalidateQueries({queryKey:["boosterData"]})},onError:e=>{console.log(e)}},u),[p,C]=z.useState(1),k=()=>{(n==null?void 0:n.name)==="Bronze"&&g({name_box:"Bronze",tg_id:o}),(n==null?void 0:n.name)=="Silver"&&g({name_box:"Silver",tg_id:o}),(n==null?void 0:n.name)=="Gold"&&g({name_box:"Gold",tg_id:o})},P=()=>{b.mutate({tg_id:o,prizes:c}),x.HapticFeedback.impactOccurred("light"),_(0),m([])};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:t.fon,children:[s.jsxs("div",{className:t.cost_window,children:[s.jsx("img",{src:$,className:t.imgCoin}),j&&s.jsx("p",{className:t.cost_text,children:D(j)})]}),s.jsx("img",{src:Es,className:t.imgEnotFace})]}),p==1&&s.jsxs("div",{className:t.box_prize,children:[s.jsxs("div",{className:t.loot_box,children:[s.jsx("img",{src:Fs,className:t.imgBumble}),s.jsx("img",{className:t.imgBox,src:r})]}),s.jsxs("div",{className:t.box_info_prize,children:[s.jsx("p",{className:t.title_prize1,children:"Ты можешь получить:"}),s.jsx("div",{className:t.possible_prize,children:i.map((e,a)=>s.jsx("img",{className:t.icon_prize,src:e},a))}),s.jsx(vs,{onClick:k})]})]}),p==2&&s.jsxs("div",{className:t.box_getting_prize,children:[l?s.jsx("p",{className:t.title_prize,children:l.Success}):s.jsx("p",{className:t.title_prize,children:"Твоя награда!"}),s.jsx("div",{className:t.getting_prize,children:c.map((e,a)=>{if(e.prize_name==="Coin Boosts")return s.jsx("img",{className:t.imgPrize,src:N},a);if(e.prize_name==="Energy Boosts")return s.jsx("img",{className:t.imgPrize,src:h},a);if(e.prize_name==="Dimonds")return s.jsx("img",{className:t.imgPrize,src:B},a);if(e.prize_name==="Bot Boosts")return s.jsx("img",{className:t.imgPrize,src:F},a)})}),!l&&s.jsx($s,{onClick:P,title:"Забрать"})]})]})}const Ds="/assets/iconCoinDisaebl-L25US0Zb.png",Ss="_box_dx6tt_1",Us="_imgBox1_dx6tt_13",qs="_cost_box_dx6tt_24",Hs="_imgCoin_dx6tt_36",Qs="_cost_text_dx6tt_44",Gs="_box_disabled_dx6tt_55",Os="_opas_dx6tt_68",f={box:Ss,imgBox1:Us,cost_box:qs,imgCoin:Hs,cost_text:Qs,box_disabled:Gs,opas:Os},Ks=({onClick:r,imgBox:n,lootBox:i})=>{const _=w(o=>{var c;return(c=o.dataUser.getUser)==null?void 0:c.coin})||0,x=(o,c)=>{if(c.price)return o>+c.price};return s.jsx(s.Fragment,{children:i&&s.jsxs("div",{onClick:r,className:`${x(_,i)?f.box:f.box_disabled}  `,children:[s.jsx("img",{className:f.imgBox1,src:n}),s.jsxs("div",{className:f.cost_box,children:[s.jsx("img",{src:`${x(_,i)?$:Ds}`,className:f.imgCoin}),(i==null?void 0:i.price)&&s.jsx("p",{className:f.cost_text,children:D(i.price)})]})]})})},E=z.memo(Ks);function Xs(){const{tg:r,tg_id:n}=Q(),[i,_]=z.useState(0),x=Y(),[o,c]=z.useState([]),m=w(e=>{var a;return(a=e.dataUser.getUser)==null?void 0:a.coin}),{data:l}=W({queryKey:["boxesData"],queryFn:()=>X(n)},u);z.useEffect(()=>{l&&(x(O(l[0])),x(K(l[1])),x(A(l[2])))},[l]);const[y,j]=z.useState(""),g=w(e=>e.lootBox1.box),b=w(e=>e.lootBox2.box),p=w(e=>e.lootBox3.box),C=()=>{m&&(g!=null&&g.price)&&m>=g.price&&(r.HapticFeedback.impactOccurred("light"),_(1),j(U),c([N,h,B]))},k=()=>{m&&(b!=null&&b.price)&&m>=b.price&&(r.HapticFeedback.impactOccurred("light"),_(2),j(q),c([N,h,B,F]))},P=()=>{m&&(p!=null&&p.price)&&m>=p.price&&(r.HapticFeedback.impactOccurred("light"),_(3),j(H),c([N,h,B,F,cs]))};return s.jsxs(L,{children:[s.jsx(T,{}),s.jsxs("div",{className:d.root,children:[i==0&&s.jsxs("div",{className:d.fon,children:[s.jsxs("div",{className:d.cost_window,children:[s.jsx("img",{src:$,className:d.imgCoin}),m&&s.jsx("p",{className:d.cost_text,children:D(m)})]}),s.jsx("h1",{className:d.slogan,children:"Твоя награда уже внутри!"}),s.jsx("p",{className:d.text_slogan,children:"Открой сундук и получи свои сокровища!"}),s.jsx("img",{src:as,className:d.imgEnotBack})]}),i==1&&s.jsx(v,{box:y,lootBox:g,imgBox:o,setTypeBox:_}),i==2&&s.jsx(v,{box:y,lootBox:b,imgBox:o,setTypeBox:_}),i==3&&s.jsx(v,{box:y,lootBox:p,imgBox:o,setTypeBox:_}),s.jsxs("div",{className:d.container,children:[s.jsx(E,{imgBox:U,lootBox:g,onClick:C}),s.jsx(E,{imgBox:q,lootBox:b,onClick:k}),s.jsx(E,{imgBox:H,lootBox:p,onClick:P})]})]})]})}export{Xs as default};
