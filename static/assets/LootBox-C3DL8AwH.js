import{j as s,u as Q,r as u,i as O,k as K,l as A,D as L}from"./index-EBoFHVxy.js";import{i as $}from"./imgCoin-DwLBqyid.js";import{H as T}from"./Header-hior3-QI.js";import{u as S}from"./useMutation-5fp4vCG5.js";import{h as I,q as z,i as M,u as W,j as X}from"./gueryClient-Bg47w06S.js";import{u as w,f as D,a as Y}from"./formatNumber-CYnDCFG3.js";const Z="_root_1lfwx_1",R="_cost_window_1lfwx_14",J="_container_1lfwx_30",V="_fon_1lfwx_40",ss="_box_1lfwx_48",es="_imgEnotBack_1lfwx_53",ts="_slogan_1lfwx_65",is="_text_slogan_1lfwx_85",os="_imgCoin_1lfwx_103",ns="_cost_text_1lfwx_111",d={root:Z,cost_window:R,container:J,fon:V,box:ss,imgEnotBack:es,slogan:ts,text_slogan:is,imgCoin:os,cost_text:ns},h="/assets/coinPrize-BsQWk6-a.png",B="/assets/energyPrize-C6pF5lWi.png",C="/assets/diamondsPrize-CaNP9zhv.png",F="/assets/botPrize-CD0cXvET.png",cs="/assets/skinPrize-Csi9GH01.png",U="/assets/box1-D3XQbKnU.png",q="/assets/box2-_a3OpZPI.png",H="/assets/box3-BQ05YlqY.png",as="/assets/imgFon-dCH78UyA.png",rs="_container_box_prize_18tw9_1",_s="_fon_18tw9_11",ms="_box_prize_18tw9_19",xs="_imgEnotFace_18tw9_27",gs="_loot_box_18tw9_39",ls="_imgBox_18tw9_47",ps="_imgBumble_18tw9_54",ds="_box_info_prize_18tw9_62",bs="_possible_prize_18tw9_72",us="_title_prize_18tw9_88",zs="_box_getting_prize_18tw9_106",js="_getting_prize_18tw9_116",fs="_imgPrize_18tw9_125",ws="_imgPrize1_18tw9_129",Ns="_icon_prize_18tw9_133",hs="_cost_window_18tw9_140",Bs="_cost_text_18tw9_156",Cs="_imgCoin_18tw9_171",t={container_box_prize:rs,fon:_s,box_prize:ms,imgEnotFace:xs,loot_box:gs,imgBox:ls,imgBumble:ps,box_info_prize:ds,possible_prize:bs,title_prize:us,box_getting_prize:zs,getting_prize:js,imgPrize:fs,imgPrize1:ws,icon_prize:Ns,cost_window:hs,cost_text:Bs,imgCoin:Cs},ks="_btn_y0wee_1",ys="_btn2_y0wee_20",G={btn:ks,btn2:ys};function Ps({...r}){return s.jsx("button",{...r,className:G.btn,children:"Получить"})}const vs="/assets/EnotFaceBackground-DCMBUzNC.png",Es="/assets/bumbleLight-_3kQzhIG.png";function Fs({...r}){return s.jsx("button",{...r,className:G.btn2,children:"Забрать"})}function v({box:r,lootBox:o,imgBox:i,setTypeBox:_}){const{tg:g,tg_id:n}=Q(),[c,m]=u.useState([]),[l,N]=u.useState(),j=w(e=>{var a;return(a=e.dataUser.getUser)==null?void 0:a.coin}),{mutate:x}=S({mutationFn:e=>I(e.name_box,e.tg_id),onSuccess:e=>{g.HapticFeedback.impactOccurred("light"),m(e),z.invalidateQueries({queryKey:["userData"]}),z.invalidateQueries({queryKey:["boxesData"]}),k(2)}},z),b=S({mutationFn:e=>M(e.prizes,e.tg_id),onSuccess:e=>{N(e),z.invalidateQueries({queryKey:["userData"]}),z.invalidateQueries({queryKey:["boosterData"]})},onError:e=>{console.log(e)}},z),[p,k]=u.useState(1),y=()=>{(o==null?void 0:o.name)==="Bronze"&&x({name_box:"Bronze",tg_id:n}),(o==null?void 0:o.name)=="Silver"&&x({name_box:"Silver",tg_id:n}),(o==null?void 0:o.name)=="Gold"&&x({name_box:"Gold",tg_id:n})},P=()=>{b.mutate({tg_id:n,prizes:c}),g.HapticFeedback.impactOccurred("light"),_(0),m([])};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:t.fon,children:[s.jsxs("div",{className:t.cost_window,children:[s.jsx("img",{src:$,className:t.imgCoin}),j&&s.jsx("p",{className:t.cost_text,children:D(j)})]}),s.jsx("img",{src:vs,className:t.imgEnotFace})]}),p==1&&s.jsxs("div",{className:t.box_prize,children:[s.jsxs("div",{className:t.loot_box,children:[s.jsx("img",{src:Es,className:t.imgBumble}),s.jsx("img",{className:t.imgBox,src:r})]}),s.jsxs("div",{className:t.box_info_prize,children:[s.jsx("p",{className:t.title_prize,children:"Ты можешь получить:"}),s.jsx("div",{className:t.possible_prize,children:i.map((e,a)=>s.jsx("img",{className:t.icon_prize,src:e},a))}),s.jsx(Ps,{onClick:y})]})]}),p==2&&s.jsxs("div",{className:t.box_getting_prize,children:[l?s.jsx("p",{className:t.title_prize,children:l.Success}):s.jsx("p",{className:t.title_prize,children:"Твоя награда!"}),s.jsx("div",{className:t.getting_prize,children:c.map((e,a)=>{if(e.prize_name==="Coin Boosts")return s.jsx("img",{className:t.imgPrize,src:h},a);if(e.prize_name==="Energy Boosts")return s.jsx("img",{className:t.imgPrize,src:B},a);if(e.prize_name==="Dimonds")return s.jsx("img",{className:t.imgPrize,src:C},a);if(e.prize_name==="Bot Boosts")return s.jsx("img",{className:t.imgPrize,src:F},a)})}),!l&&s.jsx(Fs,{onClick:P,title:"Забрать"})]})]})}const $s="/assets/iconCoinDisaebl-L25US0Zb.png",Ds="_box_dx6tt_1",Ss="_imgBox1_dx6tt_13",Us="_cost_box_dx6tt_24",qs="_imgCoin_dx6tt_36",Hs="_cost_text_dx6tt_44",Qs="_box_disabled_dx6tt_55",Gs="_opas_dx6tt_68",f={box:Ds,imgBox1:Ss,cost_box:Us,imgCoin:qs,cost_text:Hs,box_disabled:Qs,opas:Gs},Os=({onClick:r,imgBox:o,lootBox:i})=>{const _=w(n=>{var c;return(c=n.dataUser.getUser)==null?void 0:c.coin})||0,g=(n,c)=>{if(c.price)return n>+c.price};return s.jsx(s.Fragment,{children:i&&s.jsxs("div",{onClick:r,className:`${g(_,i)?f.box:f.box_disabled}  `,children:[s.jsx("img",{className:f.imgBox1,src:o}),s.jsxs("div",{className:f.cost_box,children:[s.jsx("img",{src:`${g(_,i)?$:$s}`,className:f.imgCoin}),(i==null?void 0:i.price)&&s.jsx("p",{className:f.cost_text,children:D(i.price)})]})]})})},E=u.memo(Os);function Ws(){const{tg:r,tg_id:o}=Q(),[i,_]=u.useState(0),g=Y(),[n,c]=u.useState([]),m=w(e=>{var a;return(a=e.dataUser.getUser)==null?void 0:a.coin}),{data:l}=W({queryKey:["boxesData"],queryFn:()=>X(o)},z);u.useEffect(()=>{l&&(g(O(l[0])),g(K(l[1])),g(A(l[2])))},[l]);const[N,j]=u.useState(""),x=w(e=>e.lootBox1.box),b=w(e=>e.lootBox2.box),p=w(e=>e.lootBox3.box),k=()=>{m&&(x!=null&&x.price)&&m>=x.price&&(r.HapticFeedback.impactOccurred("light"),_(1),j(U),c([h,B,C]))},y=()=>{m&&(b!=null&&b.price)&&m>=b.price&&(r.HapticFeedback.impactOccurred("light"),_(2),j(q),c([h,B,C,F]))},P=()=>{m&&(p!=null&&p.price)&&m>=p.price&&(r.HapticFeedback.impactOccurred("light"),_(3),j(H),c([h,B,C,F,cs]))};return s.jsxs(L,{children:[s.jsx(T,{}),s.jsxs("div",{className:d.root,children:[i==0&&s.jsxs("div",{className:d.fon,children:[s.jsxs("div",{className:d.cost_window,children:[s.jsx("img",{src:$,className:d.imgCoin}),m&&s.jsx("p",{className:d.cost_text,children:D(m)})]}),s.jsx("h1",{className:d.slogan,children:"Твоя награда уже внутри!"}),s.jsx("p",{className:d.text_slogan,children:"Открой сундук и получи свои сокровища!"}),s.jsx("img",{src:as,className:d.imgEnotBack})]}),i==1&&s.jsx(v,{box:N,lootBox:x,imgBox:n,setTypeBox:_}),i==2&&s.jsx(v,{box:N,lootBox:b,imgBox:n,setTypeBox:_}),i==3&&s.jsx(v,{box:N,lootBox:p,imgBox:n,setTypeBox:_}),s.jsxs("div",{className:d.container,children:[s.jsx(E,{imgBox:U,lootBox:x,onClick:k}),s.jsx(E,{imgBox:q,lootBox:b,onClick:y}),s.jsx(E,{imgBox:H,lootBox:p,onClick:P})]})]})]})}export{Ws as default};
