import{j as s,u as q,r as z,i as K,k as A,l as H,D as L}from"./index-BuGGXnwb.js";import{i as Q}from"./imgCoin-DwLBqyid.js";import{H as T}from"./Header-9hk64Cy-.js";import{u as S}from"./useMutation-BZ75-ITu.js";import{h as I,q as u,i as M,u as O,j as W}from"./gueryClient-Tsn-KKGH.js";import{u as f,f as U,a as X}from"./formatNumber-DAT3ywLA.js";const Y="_root_1gh12_1",Z="_cost_window_1gh12_14",R="_container_1gh12_30",J="_fon_1gh12_39",V="_box_1gh12_47",ss="_imgEnotBack_1gh12_52",es="_slogan_1gh12_64",is="_text_slogan_1gh12_84",ts="_imgCoin_1gh12_102",os="_cost_text_1gh12_110",x={root:Y,cost_window:Z,container:R,fon:J,box:V,imgEnotBack:ss,slogan:es,text_slogan:is,imgCoin:ts,cost_text:os},N="/assets/coinPrize-BsQWk6-a.png",v="/assets/energyPrize-C6pF5lWi.png",B="/assets/diamondsPrize-CaNP9zhv.png",E="/assets/botPrize-CD0cXvET.png",ns="/assets/skinPrize-Csi9GH01.png",$="/assets/box1-D3XQbKnU.png",F="/assets/box2-_a3OpZPI.png",w="/assets/box3-BQ05YlqY.png",cs="/assets/imgFon-dCH78UyA.png",rs="_container_box_prize_vk6cg_1",as="_fon_vk6cg_11",_s="_box_prize_vk6cg_19",gs="_imgEnotFace_vk6cg_27",ms="_loot_box_vk6cg_39",xs="_imgBox_vk6cg_47",ls="_imgBumble_vk6cg_54",ps="_box_info_prize_vk6cg_62",bs="_possible_prize_vk6cg_72",zs="_title_prize_vk6cg_88",ds="_box_getting_prize_vk6cg_102",us="_getting_prize_vk6cg_112",js="_imgPrize_vk6cg_121",hs="_imgPrize1_vk6cg_125",fs="_icon_prize_vk6cg_129",i={container_box_prize:rs,fon:as,box_prize:_s,imgEnotFace:gs,loot_box:ms,imgBox:xs,imgBumble:ls,box_info_prize:ps,possible_prize:bs,title_prize:zs,box_getting_prize:ds,getting_prize:us,imgPrize:js,imgPrize1:hs,icon_prize:fs},Ns="_btn_1opw7_1",vs="_btn2_1opw7_17",G={btn:Ns,btn2:vs};function Bs({..._}){return s.jsx("button",{..._,className:G.btn,children:"Получить"})}const ks="/assets/EnotFaceBackground-DCMBUzNC.png",Cs="/assets/bumbleLight-_3kQzhIG.png";function Ps({..._}){return s.jsx("button",{..._,className:G.btn2,children:"Забрать"})}function P({box:_,lootBox:o,imgBox:n,setTypeBox:l}){const{tg_id:r}=q(),[a,t]=z.useState([]),[g,h]=z.useState(),{mutate:d}=S({mutationFn:e=>I(e.name_box,e.tg_id),onSuccess:e=>{t(e),u.invalidateQueries({queryKey:["userData"]}),u.invalidateQueries({queryKey:["boxesData"]}),b(2)}},u),p=S({mutationFn:e=>M(e.prizes,e.tg_id),onSuccess:e=>{h(e),u.invalidateQueries({queryKey:["userData"]}),u.invalidateQueries({queryKey:["boosterData"]})},onError:e=>{console.log(e)}},u),[m,b]=z.useState(1),k=()=>{(o==null?void 0:o.name)==="Bronze"&&d({name_box:"Bronze",tg_id:r}),(o==null?void 0:o.name)=="Silver"&&d({name_box:"Silver",tg_id:r}),(o==null?void 0:o.name)=="Gold"&&d({name_box:"Gold",tg_id:r})},C=()=>{p.mutate({tg_id:r,prizes:a}),l(0),t([])};return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:i.fon,children:s.jsx("img",{src:ks,className:i.imgEnotFace})}),m==1&&s.jsxs("div",{className:i.box_prize,children:[s.jsxs("div",{className:i.loot_box,children:[s.jsx("img",{src:Cs,className:i.imgBumble}),s.jsx("img",{className:i.imgBox,src:_})]}),s.jsxs("div",{className:i.box_info_prize,children:[s.jsx("p",{className:i.title_prize,children:"Ты можешь получить:"}),s.jsx("div",{className:i.possible_prize,children:n.map((e,c)=>s.jsx("img",{className:i.icon_prize,src:e},c))}),s.jsx(Bs,{onClick:k})]})]}),m==2&&s.jsxs("div",{className:i.box_getting_prize,children:[g?s.jsx("p",{className:i.title_prize,children:g.Success}):s.jsx("p",{className:i.title_prize,children:"Твоя награда!"}),s.jsx("div",{className:i.getting_prize,children:a.map((e,c)=>{if(e.prize_name==="Coin Boosts")return s.jsx("img",{className:i.imgPrize,src:N},c);if(e.prize_name==="Energy Boosts")return s.jsx("img",{className:i.imgPrize,src:v},c);if(e.prize_name==="Dimonds")return s.jsx("img",{className:i.imgPrize,src:B},c);if(e.prize_name==="Bot Boosts")return s.jsx("img",{className:i.imgPrize,src:E},c)})}),!g&&s.jsx(Ps,{onClick:C,title:"Забрать"})]})]})}const ys="/assets/iconCoinDisaebl-L25US0Zb.png",Es="_box_1gmrz_1",Ds="_imgBox1_1gmrz_13",Ss="_cost_box_1gmrz_24",$s="_imgCoin_1gmrz_36",Fs="_cost_text_1gmrz_44",ws="_box_disabled_1gmrz_55",qs="_opas_1gmrz_68",j={box:Es,imgBox1:Ds,cost_box:Ss,imgCoin:$s,cost_text:Fs,box_disabled:ws,opas:qs},Qs=({onClick:_,imgBox:o,lootBox:n})=>{const l=f(a=>{var t;return(t=a.dataUser.getUser)==null?void 0:t.coin})||0,r=(a,t)=>{if(t.price)return a>+t.price};return s.jsx(s.Fragment,{children:n&&s.jsxs("div",{onClick:_,className:`${r(l,n)?j.box:j.box_disabled}  `,children:[s.jsx("img",{className:j.imgBox1,src:o}),s.jsxs("div",{className:j.cost_box,children:[s.jsx("img",{src:`${r(l,n)?Q:ys}`,className:j.imgCoin}),(n==null?void 0:n.price)&&s.jsx("p",{className:j.cost_text,children:U(n.price)})]})]})})},y=z.memo(Qs);function Ts(){const{tg_id:_}=q(),[o,n]=z.useState(0),l=X(),[r,a]=z.useState([]),t=f(c=>{var D;return(D=c.dataUser.getUser)==null?void 0:D.coin}),{data:g}=O({queryKey:["boxesData"],queryFn:()=>W(_)},u);z.useEffect(()=>{g&&(l(K(g[0])),l(A(g[1])),l(H(g[2])))},[g]);const[h,d]=z.useState(""),p=f(c=>c.lootBox1.box),m=f(c=>c.lootBox2.box),b=f(c=>c.lootBox3.box),k=()=>{t&&(p!=null&&p.price)&&t>=p.price&&(n(1),d($),a([N,v,B]))},C=()=>{t&&(m!=null&&m.price)&&t>=m.price&&(n(2),d(F),a([N,v,B,E]))},e=()=>{t&&(b!=null&&b.price)&&t>=b.price&&(n(3),d(w),a([N,v,B,E,ns]))};return s.jsxs(L,{children:[s.jsx(T,{}),s.jsxs("div",{className:x.root,children:[o==0&&s.jsxs("div",{className:x.fon,children:[s.jsxs("div",{className:x.cost_window,children:[s.jsx("img",{src:Q,className:x.imgCoin}),t&&s.jsx("p",{className:x.cost_text,children:U(t)})]}),s.jsx("h1",{className:x.slogan,children:"Твоя награда уже внутри!"}),s.jsx("p",{className:x.text_slogan,children:"Открой сундук и получи свои сокровища!"}),s.jsx("img",{src:cs,className:x.imgEnotBack})]}),o==1&&s.jsx(P,{box:h,lootBox:p,imgBox:r,setTypeBox:n}),o==2&&s.jsx(P,{box:h,lootBox:m,imgBox:r,setTypeBox:n}),o==3&&s.jsx(P,{box:h,lootBox:b,imgBox:r,setTypeBox:n}),s.jsxs("div",{className:x.container,children:[s.jsx(y,{imgBox:$,lootBox:p,onClick:k}),s.jsx(y,{imgBox:F,lootBox:m,onClick:C}),s.jsx(y,{imgBox:w,lootBox:b,onClick:e})]})]})]})}export{Ts as default};
