import{j as s,u as F,r as b,i as K,k as U,l as L,D as H}from"./index-BZhGot71.js";import{i as Q}from"./imgCoin-DwLBqyid.js";import{H as I}from"./Header-BraJ0-Vu.js";import{u as D}from"./useMutation-jVqjk9so.js";import{h as O,q as z,i as T,u as X,j as Z}from"./gueryClient-Cg1_ZnLl.js";import{u as N,a as M}from"./hooks-BDHb3lR9.js";import{f as G}from"./formatNumber-B_8kKFGZ.js";const Y="_root_10c39_1",J="_cost_window_10c39_14",R="_container_10c39_30",W="_box_10c39_39",V="_imgBox1_10c39_52",ss="_imgEnotBack_10c39_65",es="_slogan_10c39_76",os="_text_slogan_10c39_92",is="_cost_box_10c39_105",ts="_imgCoin_10c39_117",ns="_cost_text_10c39_125",cs="_glow_10c39_136",as="_glow_red_10c39_149",_s="_show_10c39_1",r={root:Y,cost_window:J,container:R,box:W,imgBox1:V,imgEnotBack:ss,slogan:es,text_slogan:os,cost_box:is,imgCoin:ts,cost_text:ns,glow:cs,glow_red:as,show:_s},f="/assets/coinPrize-BLAHqdfO.png",h="/assets/energyPrize-XAXyZwmo.png",w="/assets/diamondsPrize-Dnlr6o5w.png",k="/assets/botPrize-B_2tiMWo.png",rs="/assets/skinPrize-Csi9GH01.png",S="/assets/box1-D3XQbKnU.png",$="/assets/box2-_a3OpZPI.png",q="/assets/box3-BQ05YlqY.png",ms="/assets/EnotBackground-DEyn0Py-.png",xs="_container_box_prize_1o4da_1",gs="_box_prize_1o4da_11",ls="_imgEnotFace_1o4da_17",ps="_loot_box_1o4da_28",ds="_imgBox_1o4da_36",bs="_imgBumble_1o4da_43",us="_box_info_prize_1o4da_51",zs="_possible_prize_1o4da_61",js="_title_prize_1o4da_77",Bs="_box_getting_prize_1o4da_90",Ns="_getting_prize_1o4da_96",fs="_imgPrize_1o4da_105",hs="_imgPrize1_1o4da_109",ws="_icon_prize_1o4da_113",o={container_box_prize:xs,box_prize:gs,imgEnotFace:ls,loot_box:ps,imgBox:ds,imgBumble:bs,box_info_prize:us,possible_prize:zs,title_prize:js,box_getting_prize:Bs,getting_prize:Ns,imgPrize:fs,imgPrize1:hs,icon_prize:ws},ys="_btn_1opw7_1",Cs="_btn2_1opw7_17",A={btn:ys,btn2:Cs};function Ps({...m}){return s.jsx("button",{...m,className:A.btn,children:"Получить"})}const vs="/assets/EnotFaceBackground-CJx_fDe-.png",ks="/assets/bumbleLight-_3kQzhIG.png";function Es({...m}){return s.jsx("button",{...m,className:A.btn2,children:"Забрать"})}function P({box:m,lootBox:t,imgBox:n,setTypeBox:l}){const{tg_id:a}=F(),[_,i]=b.useState([]),[x,B]=b.useState(),{mutate:u}=D({mutationFn:e=>O(e.name_box,e.tg_id),onSuccess:e=>{i(e),z.invalidateQueries({queryKey:["userData"]}),z.invalidateQueries({queryKey:["boxesData"]}),d(2)}},z),p=D({mutationFn:e=>T(e.prizes,e.tg_id),onSuccess:e=>{B(e),z.invalidateQueries({queryKey:["userData"]}),z.invalidateQueries({queryKey:["boosterData"]})},onError:e=>{console.log(e)}},z),[g,d]=b.useState(1),y=()=>{(t==null?void 0:t.name)==="Bronze"&&u({name_box:"Bronze",tg_id:a}),(t==null?void 0:t.name)=="Silver"&&u({name_box:"Silver",tg_id:a}),(t==null?void 0:t.name)=="Gold"&&u({name_box:"Gold",tg_id:a})},C=()=>{p.mutate({tg_id:a,prizes:_}),l(0),i([])};return s.jsxs("div",{className:o.container_box_prize,children:[s.jsx("img",{src:vs,className:o.imgEnotFace}),g==1&&s.jsxs("div",{className:o.box_prize,children:[s.jsxs("div",{className:o.loot_box,children:[s.jsx("img",{src:ks,className:o.imgBumble}),s.jsx("img",{className:o.imgBox,src:m})]}),s.jsxs("div",{className:o.box_info_prize,children:[s.jsx("p",{className:o.title_prize,children:"Ты можешь получить:"}),s.jsx("div",{className:o.possible_prize,children:n.map((e,c)=>s.jsx("img",{className:o.icon_prize,src:e},c))}),s.jsx(Ps,{onClick:y})]})]}),g==2&&s.jsxs("div",{className:o.box_getting_prize,children:[x?s.jsx("p",{className:o.title_prize,children:x.Success}):s.jsx("p",{className:o.title_prize,children:"Твоя награда!"}),s.jsx("div",{className:o.getting_prize,children:_.map((e,c)=>{if(e.prize_name==="Coin Boosts")return s.jsx("img",{className:o.imgPrize,src:f},c);if(e.prize_name==="Energy Boosts")return s.jsx("img",{className:o.imgPrize,src:h},c);if(e.prize_name==="Dimonds")return s.jsx("img",{className:o.imgPrize,src:w},c);if(e.prize_name==="Bot Boosts")return s.jsx("img",{className:o.imgPrize,src:k},c)})}),!x&&s.jsx(Es,{onClick:C,title:"Забрать"})]})]})}const Ds="/assets/iconCoinDisaebl-L25US0Zb.png",Ss="_box_wx16u_1",$s="_imgBox1_wx16u_13",qs="_cost_box_wx16u_24",Fs="_imgCoin_wx16u_36",Qs="_cost_text_wx16u_44",Gs="_box_disabled_wx16u_55",As="_opas_wx16u_68",j={box:Ss,imgBox1:$s,cost_box:qs,imgCoin:Fs,cost_text:Qs,box_disabled:Gs,opas:As},Ks=({onClick:m,imgBox:t,lootBox:n})=>{const l=N(_=>{var i;return(i=_.dataUser.getUser)==null?void 0:i.coin})||0,a=(_,i)=>{if(i.price)return _>+i.price};return s.jsx(s.Fragment,{children:n&&s.jsxs("div",{onClick:m,className:`${a(l,n)?j.box:j.box_disabled}  `,children:[s.jsx("img",{className:j.imgBox1,src:t}),s.jsxs("div",{className:j.cost_box,children:[s.jsx("img",{src:`${a(l,n)?Q:Ds}`,className:j.imgCoin}),(n==null?void 0:n.price)&&s.jsx("p",{className:j.cost_text,children:G(n.price)})]})]})})},v=b.memo(Ks);function Zs(){const{tg_id:m}=F(),[t,n]=b.useState(0),l=M(),[a,_]=b.useState([]),i=N(c=>{var E;return(E=c.dataUser.getUser)==null?void 0:E.coin}),{data:x}=X({queryKey:["boxesData"],queryFn:()=>Z(m)},z);b.useEffect(()=>{x&&(l(K(x[0])),l(U(x[1])),l(L(x[2])))},[x]);const[B,u]=b.useState(""),p=N(c=>c.lootBox1.box),g=N(c=>c.lootBox2.box),d=N(c=>c.lootBox3.box),y=()=>{i&&(p!=null&&p.price)&&i>=p.price&&(n(1),u(S),_([f,h,w]))},C=()=>{i&&(g!=null&&g.price)&&i>=g.price&&(n(2),u($),_([f,h,w,k]))},e=()=>{i&&(d!=null&&d.price)&&i>=d.price&&(n(3),u(q),_([f,h,w,k,rs]))};return s.jsxs(H,{children:[s.jsx(I,{}),s.jsxs("div",{className:r.root,children:[s.jsxs("div",{className:r.cost_window,children:[s.jsx("img",{src:Q,className:r.imgCoin}),i&&s.jsx("p",{className:r.cost_text,children:G(i)})]}),t==0&&s.jsxs("div",{children:[s.jsx("h1",{className:r.slogan,children:"Твоя награда уже внутри!"}),s.jsx("p",{className:r.text_slogan,children:"Открой сундук и получи свои сокровища!"}),s.jsx("img",{src:ms,className:r.imgEnotBack})]}),t==1&&s.jsx(P,{box:B,lootBox:p,imgBox:a,setTypeBox:n}),t==2&&s.jsx(P,{box:B,lootBox:g,imgBox:a,setTypeBox:n}),t==3&&s.jsx(P,{box:B,lootBox:d,imgBox:a,setTypeBox:n}),s.jsxs("div",{className:r.container,children:[s.jsx(v,{imgBox:S,lootBox:p,onClick:y}),s.jsx(v,{imgBox:$,lootBox:g,onClick:C}),s.jsx(v,{imgBox:q,lootBox:d,onClick:e})]}),s.jsx("div",{className:r.glow}),s.jsx("div",{className:r.glow_red})]})]})}export{Zs as default};
