import{j as s,u as F,r as z,i as K,k as U,l as L,D as H}from"./index-DJC1mpEg.js";import{i as Q}from"./imgCoin-DwLBqyid.js";import{H as T}from"./Header-D59WUqLC.js";import{i as D}from"./box2-B7gpmBd3.js";import{a as $,i as X,q as u,j as I,u as M,k as O}from"./gueryClient-D0gj-g0n.js";import{u as k,f as G,a as Y}from"./formatNumber-C4GTjV0H.js";const Z="_root_10c39_1",J="_cost_window_10c39_14",R="_container_10c39_30",W="_box_10c39_39",V="_imgBox1_10c39_52",ss="_imgEnotBack_10c39_65",es="_slogan_10c39_76",is="_text_slogan_10c39_92",os="_cost_box_10c39_105",ts="_imgCoin_10c39_117",ns="_cost_text_10c39_125",cs="_glow_10c39_136",rs="_glow_red_10c39_149",_s="_show_10c39_1",a={root:Z,cost_window:J,container:R,box:W,imgBox1:V,imgEnotBack:ss,slogan:es,text_slogan:is,cost_box:os,imgCoin:ts,cost_text:ns,glow:cs,glow_red:rs,show:_s},N="/assets/coinPrize-BLAHqdfO.png",f="/assets/energyPrize-XAXyZwmo.png",h="/assets/diamondsPrize-Dnlr6o5w.png",v="/assets/botPrize-B_2tiMWo.png",as="/assets/skinPrize-Csi9GH01.png",S="/assets/box1-D3XQbKnU.png",q="/assets/box3-BQ05YlqY.png",ms="/assets/EnotBackground-DEyn0Py-.png",xs="_container_box_prize_1krlz_1",ls="_box_prize_1krlz_11",gs="_imgEnotFace_1krlz_17",ps="_loot_box_1krlz_28",bs="_imgBox_1krlz_36",zs="_imgBumble_1krlz_43",ds="_box_info_prize_1krlz_51",us="_possible_prize_1krlz_61",js="_title_prize_1krlz_77",Bs="_box_getting_prize_1krlz_90",ks="_getting_prize_1krlz_96",Ns="_imgPrize_1krlz_105",fs="_imgPrize1_1krlz_109",hs="_icon_prize_1krlz_113",i={container_box_prize:xs,box_prize:ls,imgEnotFace:gs,loot_box:ps,imgBox:bs,imgBumble:zs,box_info_prize:ds,possible_prize:us,title_prize:js,box_getting_prize:Bs,getting_prize:ks,imgPrize:Ns,imgPrize1:fs,icon_prize:hs},ws="_btn_1qe5k_1",ys="_btn2_1qe5k_17",A={btn:ws,btn2:ys};function Cs({...m}){return s.jsx("button",{...m,className:A.btn,children:"Получить"})}const Ps="/assets/EnotFaceBackground-CJx_fDe-.png",vs="/assets/bumbleLight-_3kQzhIG.png";function Es({...m}){return s.jsx("button",{...m,className:A.btn2,children:"Забрать"})}function C({box:m,lootBox:t,imgBox:n,setTypeBox:g}){const{tg_id:r}=F(),[_,o]=z.useState([]),[x,B]=z.useState(),{mutate:d}=$({mutationFn:e=>X(e.name_box,e.tg_id),onSuccess:e=>{o(e),u.invalidateQueries({queryKey:["userData"]}),u.invalidateQueries({queryKey:["boxesData"]}),b(2)}},u),p=$({mutationFn:e=>I(e.prizes,e.tg_id),onSuccess:e=>{B(e),u.invalidateQueries({queryKey:["userData"]}),u.invalidateQueries({queryKey:["boosterData"]})},onError:e=>{console.log(e)}},u),[l,b]=z.useState(1),w=()=>{(t==null?void 0:t.name)==="Bronze"&&d({name_box:"Bronze",tg_id:r}),(t==null?void 0:t.name)=="Silver"&&d({name_box:"Silver",tg_id:r}),(t==null?void 0:t.name)=="Gold"&&d({name_box:"Gold",tg_id:r})},y=()=>{p.mutate({tg_id:r,prizes:_}),g(0),o([])};return s.jsxs("div",{className:i.container_box_prize,children:[s.jsx("img",{src:Ps,className:i.imgEnotFace}),l==1&&s.jsxs("div",{className:i.box_prize,children:[s.jsxs("div",{className:i.loot_box,children:[s.jsx("img",{src:vs,className:i.imgBumble}),s.jsx("img",{className:i.imgBox,src:m})]}),s.jsxs("div",{className:i.box_info_prize,children:[s.jsx("p",{className:i.title_prize,children:"Ты можешь получить:"}),s.jsx("div",{className:i.possible_prize,children:n.map((e,c)=>s.jsx("img",{className:i.icon_prize,src:e},c))}),s.jsx(Cs,{onClick:w})]})]}),l==2&&s.jsxs("div",{className:i.box_getting_prize,children:[x?s.jsx("p",{className:i.title_prize,children:x.Success}):s.jsx("p",{className:i.title_prize,children:"Твоя награда!"}),s.jsx("div",{className:i.getting_prize,children:_.map((e,c)=>{if(e.prize_name==="Coin Boosts")return s.jsx("img",{className:i.imgPrize,src:N},c);if(e.prize_name==="Energy Boosts")return s.jsx("img",{className:i.imgPrize,src:f},c);if(e.prize_name==="Dimonds")return s.jsx("img",{className:i.imgPrize,src:h},c);if(e.prize_name==="Bot Boosts")return s.jsx("img",{className:i.imgPrize,src:v},c)})}),!x&&s.jsx(Es,{onClick:y,title:"Забрать"})]})]})}const Ds="/assets/iconCoinDisaebl-L25US0Zb.png",$s="_box_wx16u_1",Ss="_imgBox1_wx16u_13",qs="_cost_box_wx16u_24",Fs="_imgCoin_wx16u_36",Qs="_cost_text_wx16u_44",Gs="_box_disabled_wx16u_55",As="_opas_wx16u_68",j={box:$s,imgBox1:Ss,cost_box:qs,imgCoin:Fs,cost_text:Qs,box_disabled:Gs,opas:As},Ks=({onClick:m,imgBox:t,lootBox:n})=>{const g=k(_=>{var o;return(o=_.dataUser.getUser)==null?void 0:o.coin})||0,r=(_,o)=>{if(o.price)return _>+o.price};return s.jsx(s.Fragment,{children:n&&s.jsxs("div",{onClick:m,className:`${r(g,n)?j.box:j.box_disabled}  `,children:[s.jsx("img",{className:j.imgBox1,src:t}),s.jsxs("div",{className:j.cost_box,children:[s.jsx("img",{src:`${r(g,n)?Q:Ds}`,className:j.imgCoin}),(n==null?void 0:n.price)&&s.jsx("p",{className:j.cost_text,children:G(n.price)})]})]})})},P=z.memo(Ks);function Ms(){const{tg_id:m}=F(),[t,n]=z.useState(0),g=Y(),[r,_]=z.useState([]),o=k(c=>{var E;return(E=c.dataUser.getUser)==null?void 0:E.coin}),{data:x}=M({queryKey:["boxesData"],queryFn:()=>O(m)},u);z.useEffect(()=>{x&&(g(K(x[0])),g(U(x[1])),g(L(x[2])))},[x]);const[B,d]=z.useState(""),p=k(c=>c.lootBox1.box),l=k(c=>c.lootBox2.box),b=k(c=>c.lootBox3.box),w=()=>{o&&(p!=null&&p.price)&&o>=p.price&&(n(1),d(S),_([N,f,h]))},y=()=>{o&&(l!=null&&l.price)&&o>=l.price&&(n(2),d(D),_([N,f,h,v]))},e=()=>{o&&(b!=null&&b.price)&&o>=b.price&&(n(3),d(q),_([N,f,h,v,as]))};return s.jsxs(H,{children:[s.jsx(T,{}),s.jsxs("div",{className:a.root,children:[s.jsxs("div",{className:a.cost_window,children:[s.jsx("img",{src:Q,className:a.imgCoin}),o&&s.jsx("p",{className:a.cost_text,children:G(o)})]}),t==0&&s.jsxs("div",{children:[s.jsx("h1",{className:a.slogan,children:"Твоя награда уже внутри!"}),s.jsx("p",{className:a.text_slogan,children:"Открой сундук и получи свои сокровища!"}),s.jsx("img",{src:ms,className:a.imgEnotBack})]}),t==1&&s.jsx(C,{box:B,lootBox:p,imgBox:r,setTypeBox:n}),t==2&&s.jsx(C,{box:B,lootBox:l,imgBox:r,setTypeBox:n}),t==3&&s.jsx(C,{box:B,lootBox:b,imgBox:r,setTypeBox:n}),s.jsxs("div",{className:a.container,children:[s.jsx(P,{imgBox:S,lootBox:p,onClick:w}),s.jsx(P,{imgBox:D,lootBox:l,onClick:y}),s.jsx(P,{imgBox:q,lootBox:b,onClick:e})]}),s.jsx("div",{className:a.glow}),s.jsx("div",{className:a.glow_red})]})]})}export{Ms as default};
